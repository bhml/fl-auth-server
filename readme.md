# Auth package for FounderLab apps

Usage (server):

    import {configure as configureAuth, loggedIn} from 'fl-auth-server'

    app = express()                       // Provide your express app
    configureAuth({
      app,

      User: require('./models/user'),     // Give fl-auth-server another User model to use if you have a custom one

      middleware: {
        initialize: true,                 // enable passport middleware 
        session: true,                    // (don't change these)
      },
      paths: {
        login: '/login',                  // Route to log someone in
        register: '/register',            // Route to register a new user
        logout: '/logout',                // Route to log someone out
        reset_request: '/reset_request',  // Route to request a password reset email be sent
                                          // must provide `email` as a param in the body, e.g. {email: 'a@example.com'} 
        reset: '/reset',                  // Route that a user will visit to perform their password reset. 
                                          // Requires `reset_token` as a param. This token is generated by the reset_request 
                                          // and should be passed through via the email you sent them from their reset_request.
        success: '/',                     // Go here when a user logs in or registers 
                                          // (if there's no other location specified) <- This isn't implemented yet
      },
      facebook: {                         // facebook login info
        url: process.env.URL,
        paths: {
          redirect: '/auth/facebook',
          callback: '/auth/facebook/callback',
        },
        scope: ['email'],
        profile_fields: ['id', 'displayName', 'email'],
      },
      login: {                          
        username_field: 'email',                                // The login/register strategies look for these properties
        password_field: 'password',                             // on the request body
        bad_request_message: 'Missing credentials',             // If username or password is missing this is sent
        reset_token_expires_ms: 1000 * 60 * 60 * 24 * 7,        // Reset tokens expire in 7 days by default
      },

      // You need to override this with a function that sends this user an email with a link to the reset page, 
      // with a query param containing this reset_token 
      // e.g. <a href="https://example.com/reset?reset_token=${user.get('reset_token')}>Reset your password here</a>
      sendResetEmail: (user, callback) => {
        console.log('[fl-auth] sendResetEmail not configured. No password reset email will be sent. Reset token:', user.get('email'), user.get('reset_token'))
        callback()
      },

    })
